import { themes, Footer, Head } from "mdx-deck";

import { CodeSurfer } from "code-surfer";
import { GitHub } from "@code-surfer/themes";
import "prismjs/components/prism-rust";
import { default as style } from "./resources/theme";

import poster from "./resources/images/poster.png";

<Footer>
  <h1>A tour of Rust</h1>
</Footer>

export const theme = style;

<img
  src={poster}
  style={{
    width: "100%",
    height: "100%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---
<CodeSurfer theme={GitHub}>

```cpp title="Memory safety example"
#include<iostream>
#include<vector>
#include<string>

int main(int argc, char *argv[])
{
	std::vector<std::string> strings;

	strings.push_back("Hello");
	strings.push_back("World");

	std::string& ref = strings[0];

	add_more_strings(&strings);

	std::cout << ref << std::endl;
	return 0;
}

```

```cpp 12,14 title="Memory safety example"
#include<iostream>
#include<vector>
#include<string>

int main(int argc, char *argv[])
{
	std::vector<std::string> strings;

	strings.push_back("Hello");
	strings.push_back("World");

	std::string& ref = strings[0];

	add_more_strings(&strings);

	std::cout << ref << std::endl;
	return 0;
}

```

</CodeSurfer>

---

# Origin of rust

import originofrust from "./resources/images/originofrust.png";

<img
  src={originofrust}
  style={{
    width: "80%",
    height: "80%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

# Linear typesystem

> "Linear type systems ensure that every variable is used exactly once by allowing exchange but not weakening or contraction."
> <cite>Benjamin Pierce</cite>

---

# Ownership

import ownership1 from "./resources/images/ownership1.png";

<img
  src={ownership1}
  style={{
    width: "80%",
    height: "80%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

# Ownership

import ownership2 from "./resources/images/ownership2.png";

<img
  src={ownership2}
  style={{
    width: "80%",
    height: "80%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

# Ownership

import ownership3 from "./resources/images/ownership3.png";

<img
  src={ownership3}
  style={{
    width: "80%",
    height: "80%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

# Borrowing 

import borrowing from "./resources/images/borrowing.png";

<img
  src={borrowing}
  style={{
    width: "80%",
    height: "80%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

<CodeSurfer theme={GitHub}>

```rust title="Ownership example"
fn uppercase(mut input: String) {
    input = input.to_uppercase();
}

fn main() {
    let mut output = String::from("hello world.");
    uppercase(output);
}
```

```rust 8 title="Ownership example"
fn uppercase(mut input: String) {
    input = input.to_uppercase();
}

fn main() {
    let mut output = String::from("hello world.");
    uppercase(output);
    println!("{}", output);
}
```

```rust
error[E0382]: borrow of moved value: `output`
 --> src/main.rs:8:18
  |
6 |     let output = String::from("hello world.");
  |         ------ move occurs because `output` has type `std::string::String`, which does not implement the `Copy` trait
7 |     uppercase(output);
  |               ------ value moved here
8 |     println!("{}", output);
  |                    ^^^^^^ value borrowed here after move

error: aborting due to previous error

For more information about this error, try `rustc --explain E0382`.
error: could not compile `ownership`.

To learn more, run the command again with --verbose.

```

```rust 1,7 title="Borrowing example"
fn uppercase(input: &mut String) {
    *input = input.to_uppercase();
}

fn main() {
    let mut output = String::from("hello world.");
    uppercase(&mut output);
    print!("{}", output);
}
```

</CodeSurfer>

---
4. enums
---

# Error handling

import dontpanic from "./resources/images/dontpanic.jpeg";

<img
  src={dontpanic}
  style={{
    width: "50%",
    height: "50%",
    display: "flex",
    alignItems: "center",
    justifyContent: "center",
  }}
/>

---

<CodeSurfer theme={GitHub}>

```rust title="Panic example"
fn do_something() {
    panic!("Oh noes!");
}

fn main() {
    do_something();
}
```

```rust 5 title="Panic example"
micha@linux:~/asml-tour-of-rust/panic (main)> cargo run
   Compiling panic v0.1.0 (/home/micha/asml-tour-of-rust/panic)
    Finished dev [unoptimized + debuginfo] target(s) in 0.23s
     Running `target/debug/panic`
thread 'main' panicked at 'Oh noes!', src/main.rs:2:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

```
```rust title="Result type"
enum Result<T,E> {
	Ok(T),
	Err(E),
}
```

```rust title="Error example"
use std::fs::File;

fn main() {
    let f = File::open("hello.txt");

    let f = match f {
        Ok(file) => file,
        Err(error) => panic!("Problem opening the file: {:?}", error),
    };
}

```

</CodeSurfer>

---
6. polymorphism
---
7. concurrency
---
8. macros
---
9. unsafe
---
10. modules
---
11. macros
---
12. std::lib
---
13. integrated test & benchmark
---
14. releases
---

## The End

---

<CodeSurfer theme={GitHub}>


```rust

// Don't inline this so callers that call both this and the above won't wind
// up using the combined stack space of both functions in some cases.
#[inline(never)]
fn float_to_decimal_common_shortest<T>(
    fmt: &mut Formatter<'_>,
    num: &T,
    sign: flt2dec::Sign,
    precision: usize,
) -> Result
where
    T: flt2dec::DecodableFloat,
{
    // enough for f32 and f64
    let mut buf: [MaybeUninit<u8>; flt2dec::MAX_SIG_DIGITS] = MaybeUninit::uninit_array();
    let mut parts: [MaybeUninit<flt2dec::Part<'_>>; 4] = MaybeUninit::uninit_array();
    let formatted = flt2dec::to_shortest_str(
        flt2dec::strategy::grisu::format_shortest,
        *num,
        sign,
        precision,
        &mut buf,
        &mut parts,
    );
    fmt.pad_formatted_parts(&formatted)
}

// Common code of floating point Debug and Display.
fn float_to_decimal_common<T>(
    fmt: &mut Formatter<'_>,
    num: &T,
    negative_zero: bool,
    min_precision: usize,
) -> Result
where
    T: flt2dec::DecodableFloat,
{
    let force_sign = fmt.sign_plus();
    let sign = match (force_sign, negative_zero) {
        (false, false) => flt2dec::Sign::Minus,
        (false, true) => flt2dec::Sign::MinusRaw,
        (true, false) => flt2dec::Sign::MinusPlus,
        (true, true) => flt2dec::Sign::MinusPlusRaw,
    };

    if let Some(precision) = fmt.precision {
        float_to_decimal_common_exact(fmt, num, sign, precision)
    } else {
        float_to_decimal_common_shortest(fmt, num, sign, min_precision)
    }
}
```

</CodeSurfer>

